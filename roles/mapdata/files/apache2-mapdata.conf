<VirtualHost *:80>
        ServerName mapdata.freifunk-vogtland.net
        ServerAdmin info@freifunk-vogtland.net
        DocumentRoot /var/www/meshviewer/ffv
	Protocols h2c http/1.1

        <Directory "/var/www/meshviewer/ffv">
                AddOutputFilterByType DEFLATE application/json
        </Directory>

        ErrorLog ${APACHE_LOG_DIR}/error.log
        CustomLog ${APACHE_LOG_DIR}/access.log combined

        Header set Access-Control-Allow-Origin "*"

	ProxyPreserveHost On
	ProxyPass /fastd_load http://169.254.0.4:26725/stats
</VirtualHost>

<VirtualHost *:443>
        ServerName mapdata.freifunk-vogtland.net
        ServerAdmin info@freifunk-vogtland.net
        DocumentRoot /var/www/meshviewer/ffv
        Protocols h2 http/1.1

        <Directory "/var/www/meshviewer/ffv">
                AddOutputFilterByType DEFLATE application/json
        </Directory>

        ErrorLog ${APACHE_LOG_DIR}/error.log
        CustomLog ${APACHE_LOG_DIR}/access.log combined

        SSLEngine on
        SSLCertificateFile    /etc/letsencrypt/live/mapdata.freifunk-vogtland.net/fullchain.pem
        SSLCertificateKeyFile /etc/letsencrypt/live/mapdata.freifunk-vogtland.net/privkey.pem
        SSLCACertificateFile /etc/ssl/certs/ca-certificates.crt

        Include /etc/letsencrypt/options-ssl.conf
        Header always set Strict-Transport-Security "max-age=15768000; includeSubDomains; preload"

        Header set Access-Control-Allow-Origin "*"

	ProxyPreserveHost On
	ProxyPass /fastd_load http://169.254.0.4:26725/stats
</VirtualHost>

